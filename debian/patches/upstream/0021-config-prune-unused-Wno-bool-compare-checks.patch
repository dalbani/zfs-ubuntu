From 2d235d58f829e47709ab587bd2be936f69bc6cff Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?=D0=BD=D0=B0=D0=B1?= <nabijaczleweli@nabijaczleweli.xyz>
Date: Wed, 16 Feb 2022 16:08:20 +0100
Subject: [PATCH] config: prune unused -Wno-bool-compare checks
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Reviewed-by: Alejandro Colomar <alx.manpages@gmail.com>
Reviewed-by: Brian Behlendorf <behlendorf1@llnl.gov>
Signed-off-by: Ahelenia Ziemia≈Ñska <nabijaczleweli@nabijaczleweli.xyz>
Closes #13110
---
 config/always-compiler-options.m4 | 27 ---------------------------
 config/zfs-build.m4               |  1 -
 2 files changed, 28 deletions(-)

diff --git a/config/always-compiler-options.m4 b/config/always-compiler-options.m4
index 0028f4bbea..1df98d6dc6 100644
--- a/config/always-compiler-options.m4
+++ b/config/always-compiler-options.m4
@@ -108,33 +108,6 @@ AC_DEFUN([ZFS_AC_CONFIG_ALWAYS_CC_NO_FORMAT_ZERO_LENGTH], [
 	AC_SUBST([NO_FORMAT_ZERO_LENGTH])
 ])
 
-
-dnl #
-dnl # Check if gcc supports -Wno-bool-compare option.
-dnl #
-dnl # We actually invoke gcc with the -Wbool-compare option
-dnl # and infer the 'no-' version does or doesn't exist based upon
-dnl # the results.  This is required because when checking any of
-dnl # no- prefixed options gcc always returns success.
-dnl #
-AC_DEFUN([ZFS_AC_CONFIG_ALWAYS_CC_NO_BOOL_COMPARE], [
-	AC_MSG_CHECKING([whether $CC supports -Wno-bool-compare])
-
-	saved_flags="$CFLAGS"
-	CFLAGS="$CFLAGS -Werror -Wbool-compare"
-
-	AC_COMPILE_IFELSE([AC_LANG_PROGRAM([], [])], [
-		NO_BOOL_COMPARE=-Wno-bool-compare
-		AC_MSG_RESULT([yes])
-	], [
-		NO_BOOL_COMPARE=
-		AC_MSG_RESULT([no])
-	])
-
-	CFLAGS="$saved_flags"
-	AC_SUBST([NO_BOOL_COMPARE])
-])
-
 dnl #
 dnl # Check if gcc supports -Wno-clobbered option.
 dnl #
diff --git a/config/zfs-build.m4 b/config/zfs-build.m4
index 2be007149c..8abeb51ad3 100644
--- a/config/zfs-build.m4
+++ b/config/zfs-build.m4
@@ -210,7 +210,6 @@ AC_DEFUN([ZFS_AC_CONFIG_ALWAYS], [
 	AC_SUBST(CPU_COUNT)
 
 	ZFS_AC_CONFIG_ALWAYS_CC_NO_CLOBBERED
-	ZFS_AC_CONFIG_ALWAYS_CC_NO_BOOL_COMPARE
 	ZFS_AC_CONFIG_ALWAYS_CC_IMPLICIT_FALLTHROUGH
 	ZFS_AC_CONFIG_ALWAYS_CC_FRAME_LARGER_THAN
 	ZFS_AC_CONFIG_ALWAYS_CC_NO_FORMAT_TRUNCATION
-- 
2.34.1

